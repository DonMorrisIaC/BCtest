apiVersion: apps/v1
kind: Deployment
metadata:
  name: hello
  namespace: demo
spec:
  replicas: 2
  selector:
    matchLabels: { app: hello }
  template:
    metadata:
      labels: { app: hello }
    spec:
      containers:
        - name: web
          image: ghcr.io/nginxinc/nginx-unprivileged:1.27-alpine
          ports: [{ containerPort: 8080 }]
          args: ["sh", "-c", "printf 'HTTP/1.1 200 OK\r\n\r\nHello from AKS via Argo CD\n' | while true; do nc -l -p 8080 -k -q 1 -s 0.0.0.0; done"]
          readinessProbe:
            tcpSocket: { port: 8080 }
            initialDelaySeconds: 2
            periodSeconds: 5
